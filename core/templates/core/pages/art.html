{% extends "core/extendables/base.html" %}

{% load static %}

{% block title %}{{ art.title }} by {{ art.artist.username }}{% endblock %}

{% block og %}
<meta property="og:image" content="{{ art.thumb_render.url }}" />
{% endblock %}

{% block path %}
<li><a href="{% url 'core:index' %}" >home</a></li>
<li><a href="{% url 'core:arts' %}" >art</a></li>
<li>{{ art.pk }}</li>
{% endblock %}

{% block content %}
<h2>{{ art.title }}</h2>

<p>by {{ art.artist.username }}
{% if request.user.is_authenticated and request.user != art.artist %}
{% if request.user not in art.artist.following.all %}
<span id="follow-button-{{ art.artist.username }}" class="follow-button follow">Follow</span>
{% else %}
<span id="follow-button-{{ art.artist.username }}" class="follow-button unfollow">Unfollow</span>
{% endif %}
{% endif %}
</p>

<pre class="art{% if art.nsfw %} nsfw blur{% endif %}">{{ art.text }}</pre>

<span id="art-like-{{ art.pk }}" class="art-like" >
<span class="art-like-tally">{{ art.likes.count }}</span>
{% if request.user.is_authenticated %}
{% if request.user not in art.likes.all %}
<span class="like-art like">Like</span>
{% else %}
<span class="like-art unlike">Unlike</span>
{% endif %}
{% endif %}
</span>

{% if art.description %}
<div>{{ art.description | linebreaks }}</div>
{% endif %}

{% if comments %}
{% for comment in comments %}
<p>{{ comment.author.username }}</p>
<div>{{ comment.text }}</div>
<br />
{% endfor %}

{% include "core/includes/pagination.html" %}
{% endif %}

<form method="post">
    {% csrf_token %}
    {{ comment_form.as_p }}
    <input type="submit" value="Comment" />
</form>

{% if request.user == art.artist %}
<p><a href="{% url 'core:edit_art' art.pk %}">Edit</a></p>
{% endif %}
{% endblock %}

{% block js %}
{% if request.user.is_authenticated %}
<script src="{% static 'core/js/like_art.js' %}"></script>
{% if request.user != art.artist %}
<script src="{% static 'core/js/follow_user.js' %}"></script>
{% endif %}
{% endif %}
{% endblock %}
